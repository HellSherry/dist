import{_ as S,u as I,b,H as Y,e as n,o as H,c as N,f as t,w as a,a as u,n as P,k as w,s as g,M as d,g as i,t as k,l as T,G as q}from"./index-1858008c.js";const E={style:{position:"relative",height:"102vh"}},G={style:{display:"inline-block",float:"right",width:"200px","margin-left":"10px"}},A={__name:"MessageMsgView",setup(F){const V=I(),f=b(),c=b({records:[{id:1,title:"这是一条通知",details:"这是通知详情",addtime:"2024-01-10T11:15:42.000+00:00"}],total:1,size:10,current:1,pages:1}),e=Y({isUpdate:!1,selectedRowKeys:[],visible:!1,page:1,search:"",pojo:{title:"",details:""}});function r(){g.get(`/message/page?page=${e.page}&size=10&search=${e.search}`).then(s=>{c.value=s.data,console.log(s)})}r();async function M(){typeof await f.value.validate()=="boolean"&&g.post(`/message/${e.isUpdate?"update":"insert"}`,e.pojo).then(s=>{console.log(11121),console.log(s),r(),s.data>0?d.success((e.isUpdate?"修改":"新增")+"成功"):d.error((e.isUpdate?"修改":"新增")+"失败"),e.visible=!1})}function x(){if(e.selectedRowKeys.length>0){const s=q({header:"提示",body:"您确认删除所选 "+e.selectedRowKeys.length+" 项数据吗？",confirmBtn:{content:"删除",theme:"danger"},cancelBtn:{content:"取消",variant:"outline"},onConfirm:({e:o})=>{_(e.selectedRowKeys),s.hide()}})}else d.error("请选择要删除的项")}function _(s){g.post("/message/delete",typeof s=="object"?s:[s]).then(o=>{console.log(o),r(),o.data>0?d.success("删除成功"):d.error("删除失败")})}return(s,o)=>{const m=n("t-input"),h=n("t-form-item"),z=n("t-form"),C=n("t-dialog"),p=n("t-icon"),y=n("t-button"),K=n("t-tag"),j=n("t-space"),U=n("t-pagination"),v=n("t-link"),$=n("t-popconfirm"),B=n("t-table"),D=n("t-card");return H(),N("div",E,[t(C,{placement:"center",header:e.isUpdate?"编辑通知":"新增通知",visible:e.visible,"on-confirm":()=>M(),"on-close":()=>e.visible=!1},{default:a(()=>[t(z,{layout:"inline",ref_key:"form",ref:f,rules:{title:[{required:!0,message:"标题不能为空"}],details:[{required:!0,message:"内容不能为空"}]},data:e.pojo,colon:!0},{default:a(()=>[t(h,{style:{width:"96%",margin:"8px 0"},label:"通知标题",name:"title"},{default:a(()=>[t(m,{modelValue:e.pojo.title,"onUpdate:modelValue":o[0]||(o[0]=l=>e.pojo.title=l),placeholder:"请输入内容"},null,8,["modelValue"])]),_:1}),t(h,{style:{width:"96%",margin:"8px 0"},label:"通知内容",name:"details"},{default:a(()=>[t(m,{modelValue:e.pojo.details,"onUpdate:modelValue":o[1]||(o[1]=l=>e.pojo.details=l),placeholder:"请输入内容"},null,8,["modelValue"])]),_:1})]),_:1},8,["data"])]),_:1},8,["header","visible","on-confirm","on-close"]),u("div",{style:P([{"background-position":"center"},`background-image: url('${w(V).darkT?`//pic.sherry.games/assets/image/mobileback/th (${Math.round(Math.random()*30)}).jpg`:`//pic.sherry.games/assets/image/mobileback/th (${Math.round(Math.random()*30)}).jpg`}');background-repeat: no-repeat;background-size: cover;min-height: 46vh ;margin-top: -20px`])},null,4),t(D,{bordered:!1,hoverShadow:"",style:{width:"96%",margin:"0 auto","margin-top":"-30px","min-height":"58vh"}},{default:a(()=>[u("div",null,[t(j,{size:6},{default:a(()=>[t(y,{size:"small",onClick:o[2]||(o[2]=l=>{e.visible=!0,e.isUpdate=!1,s.$refs.form.reset()}),theme:"primary"},{icon:a(()=>[t(p,{name:"add"})]),default:a(()=>[i(" 新建 ")]),_:1}),t(y,{size:"small",onClick:x,theme:"danger"},{icon:a(()=>[t(p,{name:"delete"})]),default:a(()=>[i(" 删除 ")]),_:1}),t(K,{variant:"light-outline",theme:"primary",shape:"round",size:"small"},{default:a(()=>[i(" 共有"+k(c.value.total)+"条记录 ",1)]),_:1})]),_:1}),u("div",G,[t(U,{totalContent:!1,onChange:r,modelValue:e.page,"onUpdate:modelValue":o[3]||(o[3]=l=>e.page=l),theme:"simple",showPageSize:!1,size:"small",total:c.value.total},null,8,["modelValue","total"])]),t(m,{onInput:o[4]||(o[4]=l=>{e.page=1,r()}),modelValue:e.search,"onUpdate:modelValue":o[5]||(o[5]=l=>e.search=l),modelModifiers:{lazy:!0},size:"small",style:{width:"20%",float:"right"},placeholder:"输入内容",clearable:""},{suffixIcon:a(()=>[t(p,{style:{cursor:"pointer"},name:"search"})]),_:1},8,["modelValue"])]),t(B,{size:"small","row-key":"id","selected-row-keys":e.selectedRowKeys,"onUpdate:selectedRowKeys":o[6]||(o[6]=l=>e.selectedRowKeys=l),data:c.value.records,columns:[{colKey:"row-select",type:"multiple",width:60},{colKey:"id",title:"ID"},{colKey:"title",title:"标题",ellipsis:!0},{colKey:"details",title:"详情"},{colKey:"addtime",title:"创建时间"},{title:"操作",colKey:"operation"}]},{addtime:a(({row:l})=>[i(k(w(T)(l.addtime).format("YYYY-MM-DD HH:mm:ss")),1)]),operation:a(({row:l})=>[t(v,{onClick:R=>{e.visible=!0,e.isUpdate=!0,e.pojo={...l}},theme:"primary",hover:"color"},{default:a(()=>[i(" 修改 ")]),_:2},1032,["onClick"]),i("  "),t($,{theme:"danger",confirmBtn:{theme:"danger"},onConfirm:R=>_(l.id),cancelBtn:{variant:"outline"},content:"确认删除吗"},{default:a(()=>[t(v,{theme:"danger",hover:"color"},{default:a(()=>[i(" 删除 ")]),_:1})]),_:2},1032,["onConfirm"])]),_:1},8,["selected-row-keys","data"])]),_:1})])}}},L=S(A,[["__scopeId","data-v-cdb45f82"]]);export{L as default};
