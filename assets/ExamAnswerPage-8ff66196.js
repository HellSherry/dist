import{_ as K,u as W,b as v,D as Y,s as N,l as b,M as I,E as Z,x as ee,d as te,e as s,o as p,c as S,a as o,f as i,w as n,n as B,i as $,g as _,t as V,k as oe,r as J,F as M,h as ae,G as se,p as ne,m as le}from"./index-1858008c.js";import{_ as re}from"./ToHtml-a2ee5490.js";import{A as ie}from"./AnswerUI-9765005f.js";/* empty css                                               *//* empty css                                                                 */const h=y=>(ne("data-v-64234d2d"),y=y(),le(),y),de={style:{"min-height":"100vh","backdrop-filter":"blur(20px)","padding-top":"1.6vh","padding-bottom":"10px"}},ue={style:{"font-size":"20PX",width:"460px",margin:"0 auto","margin-top":"12vh"}},ce={style:{"user-select":"none","margin-top":"20vh","font-size":"28px"}},me={style:{"font-size":"60px"}},pe=h(()=>o("p",null,"为防止泄题，本场考试结束结束后可以查看答案！",-1)),_e=h(()=>o("div",null,null,-1)),he=h(()=>o("div",{style:{height:"56px"}},null,-1)),ve=h(()=>o("br",null,null,-1));const ge={key:2,style:{"text-align":"center"}},fe=h(()=>o("h1",{style:{"font-size":"60px","line-height":"80px"}},[_(" 502 "),o("br"),_(" Sorry,你暂时没有本场考试权限 ")],-1)),xe=h(()=>o("a",{href:"/"},"clickhere to home",-1)),we=[fe,xe],be=h(()=>o("span",{style:{"text-align":"center"}},[o("p",null,"长沙创科职校 0731-8455-6741 | 长沙市芙蓉区"),o("p",null," 湘ICP备2023020435号| Copyright © icloud All rights reserved")],-1)),ye={__name:"ExamAnswerPage",setup(y){const d=W(),u=v(-1),t=Y.currentRoute.value.params.id,c=v([]),g=v([]);sessionStorage.getItem(`exam-${t}-${d.loginUser.sub.userId}-score`)!=null?u.value=sessionStorage.getItem(`exam-${t}-${d.loginUser.sub.userId}-score`):(sessionStorage.getItem(`exam-${t}`)!=null?c.value=JSON.parse(sessionStorage.getItem(`exam-${t}`)):N.get("/exam/getExamById?paperId="+t).then(e=>{c.value=e.data,sessionStorage.setItem(`exam-${t}`,JSON.stringify(c.value)),L()}),sessionStorage.getItem(`exam-${t}-${d.loginUser.sub.userId}`)!=null?g.value=JSON.parse(sessionStorage.getItem(`exam-${t}-${d.loginUser.sub.userId}`)):N.get("/exam/getPaper?paperId="+t).then(e=>{typeof e.data=="object"?(g.value=e.data,sessionStorage.setItem(`exam-${t}-${d.loginUser.sub.userId}`,JSON.stringify(g.value)),C()):(u.value=e.data,sessionStorage.setItem(`exam-${t}-${d.loginUser.sub.userId}-score`,JSON.stringify(u.value)))})),L();function L(){if(c.value.length!==0&&(b(c.value.starttime).valueOf()+c.value.duration*1e3*60<b().valueOf()&&(I.error("本场考试已经结束了哦"),sessionStorage.clear()),b(c.value.starttime).valueOf()>b().valueOf())){I.error("本场考试未开始");const e=document.getElementById("audioController");e.src="//pic.sherry.games/assets/audio/2869.wav",e.play()}}const a=v([]);function C(){if(sessionStorage.getItem(`exam-${t}-${d.loginUser.sub.userId}-answer`)!=null)a.value=JSON.parse(sessionStorage.getItem(`exam-${t}-${d.loginUser.sub.userId}-answer`));else for(let e=0;e<g.value.length;e++)a.value.push([])}C();const ke=v(1);Z(()=>{a.value.join("").trim()!=""&&u.value===-1&&(I.error("正在考试中…"),history.pushState())}),ee(a.value,e=>{sessionStorage.setItem(`exam-${t}-${d.loginUser.sub.userId}-answer`,JSON.stringify(e))});var f;function U(){if(a.value.join("").trim()!=""&&u.value===-1){const e=document.getElementById("audioController");e.src="//pic.sherry.games/assets/audio/"+(Math.random()>.5?"3360":"4397")+".wav",e.play()}}const E=()=>{f!==void 0&&window.clearTimeout(f),U(),document.title="用户切屏啦"},T=()=>{f!==void 0&&window.clearTimeout(f),U(),document.title="用户回来啦",f=setTimeout(()=>{document.title="北大青鸟长沙创科校区"},3e3)};window.addEventListener("blur",E),window.addEventListener("focus",T),te(()=>{window.removeEventListener("blur",E),window.removeEventListener("focus",T)});function P(e){document.getElementById(`answer${e}`).scrollIntoView({behavior:"smooth",block:"center"})}const x=v({});function z(){let e=[];a.value.forEach((l,k)=>{l.length===0?e.push(0):e.push(l.sort().join(","))}),N.post("/exam/calculateTheScore?answers="+e.join("-")+"&paperId="+t).then(l=>{u.value=l.data.toFixed(1),I.success("成绩："+u.value),sessionStorage.setItem(`exam-${t}-${d.loginUser.sub.userId}-score`,JSON.stringify(u.value)),console.log(l)}),console.log(e.join("-"))}function D(){const e=se({header:"提示",body:"您确认交卷吗？",confirmBtn:"提交考卷",cancelBtn:"继续做题",onConfirm:({e:l})=>{console.log("confirm button has been clicked!"),console.log("e: ",l),z(),e.hide()},onClose:({e:l,trigger:k})=>{console.log("e: ",l),console.log("trigger: ",k),e.hide()}})}return(e,l)=>{const k=s("nut-animate"),O=s("t-card"),F=s("nut-countdown"),H=s("t-progress"),j=s("t-button"),A=s("t-space"),Q=s("t-aside"),q=s("t-check-tag"),Ie=s("t-tab-panel"),Se=s("t-tabs"),R=s("t-footer"),G=s("t-content"),X=s("t-layout");return u.value!==-1?(p(),S("div",{key:0,style:B([{"background-position":"center"},`background-image: url('//pic.sherry.games/assets/image/mobileback/th (${Math.round(Math.random()*30)}).jpg');background-repeat: no-repeat;background-size: cover;  `])},[o("div",de,[i(O,{bordered:!1,hoverShadow:"",style:{width:"96%",margin:"0 auto","min-height":"90vh"}},{default:n(()=>[o("div",ue,[i(k,{type:"jump",show:!0},{default:n(()=>[o("h2",ce,[_(" 你的考试成绩是"),o("span",me,V(u.value),1),_("分 ")]),pe]),_:1})])]),_:1})])],4)):(p(),$(X,{key:1},{default:n(()=>[i(Q,{style:{overflow:"hidden",width:"300px"}},{default:n(()=>[i(H,{size:"large",class:"aline-center",style:{width:"160px",margin:"10% auto 10px auto"},percentage:(x.value.s+(x.value.m+x.value.h*60)*60)*(100/(c.value.duration*60)),theme:"circle"},{label:n(()=>[i(F,{onEnded:z,style:{display:"inline","user-select":"none","font-size":"28px"},"end-time":oe(b)(c.value.starttime).valueOf()+c.value.duration*60*1e3,modelValue:x.value,"onUpdate:modelValue":l[0]||(l[0]=m=>x.value=m)},null,8,["end-time","modelValue"])]),_:1},8,["percentage"]),i(j,{size:"large",shape:"round",style:{margin:"20px 4%",width:"92%"},onClick:D},{default:n(()=>[_(" 我要交卷 ")]),_:1}),i(A,{size:12,style:{"margin-left":"7%","max-height":"50vh",overflow:"auto"},"break-line":""},{default:n(()=>[(p(!0),S(M,null,J(a.value,(m,r)=>(p(),$(j,{style:{"border-radius":"12px"},variant:m.length>0?"base":"dashed",theme:"primary",shape:"square",onClick:w=>P(r)},{default:n(()=>[_(V(r+1),1)]),_:2},1032,["variant","onClick"]))),256))]),_:1}),_e]),_:1}),i(G,{style:{overflow:"auto",height:"100vh","margin-top":"-56px"}},{default:n(()=>[he,(p(),$(A,{key:0,style:{width:"100%"},direction:"vertical"},{default:n(()=>[(p(!0),S(M,null,J(g.value,(m,r)=>(p(),$(O,{id:`answer${r}`,style:{width:"80%",margin:"20px auto","min-width":"100px","max-width":"800px"},bordered:!1,hoverShadow:"",size:"small",theme:"poster2"},{default:n(()=>[o("div",{style:B(a.value[r]==null||a.value[r]==""?"":"background-color: var(--td-brand-color-4);"),class:"subscribe"},[o("div",{style:B("position: absolute;left: 1px;top: 46px;width: 0;height: 0;border-right: 0px solid transparent;border-left: 9px solid transparent;border-top: 9px solid var(--td-brand-color-"+(a.value[r]==null||a.value[r]==""?"8":"5")+");"),class:"sdf"},null,4),_(" Topic "+V((r+1+"").padStart(2,"0")),1)],4),i(q,{style:{float:"right","margin-top":"4px"},checked:!0,"checked-props":{theme:"primary",variant:"outline"}},{default:n(()=>[_("选择 "+V(m[2])+" 项 ",1)]),_:2},1024),ve,i(re,{style:{overflow:"hidden",width:"90%",margin:"0 auto","font-weight":"600"},innerHTML:m[0]},null,8,["innerHTML"]),i(ie,{answerLen:m[2],style:{overflow:"hidden",width:"90%",margin:"30px auto"},checkbox:!1,modelValue:a.value[r],"onUpdate:modelValue":w=>a.value[r]=w,options:JSON.parse(m[1])},null,8,["answerLen","modelValue","onUpdate:modelValue","options"])]),_:2},1032,["id"]))),256))]),_:1})),a.value.length===0?(p(),S("div",ge,we)):ae("",!0),i(R,null,{default:n(()=>[be]),_:1})]),_:1})]),_:1}))}}},Ce=K(ye,[["__scopeId","data-v-64234d2d"]]);export{Ce as default};
